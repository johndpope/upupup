jQuery(document).ready(function(jQuery){var __cancel=jQuery('#cancel-comment-reply-link'),__cancel_text=__cancel.text(),__list='comment-list';jQuery(document).on("submit","#commentform",function(){jQuery.ajax({url:xb.ajax_url,data:jQuery(this).serialize()+"&action=ajax_comment",type:jQuery(this).attr('method'),beforeSend:addComment.createButterbar("正在提交"),error:function(request){var t=addComment;t.createButterbar(request.responseText)},success:function(data){jQuery('textarea').each(function(){this.value=''});var t=addComment,cancel=t.I('cancel-comment-reply-link'),temp=t.I('wp-temp-form-div'),respond=t.I(t.respondId),post=t.I('comment_post_ID').value,parent=t.I('comment_parent').value;if(parent!='0'){jQuery('#respond').before('<ol class="children">'+data+'</ol>')}else if(!jQuery('.'+__list).length){jQuery('#comments-nav').before('<ol class="'+__list+'">'+data+'</ol>')}else{if(xb.order=='asc'){jQuery('.'+__list).append(data)}else{jQuery('.'+__list).prepend(data)}}t.createButterbar("提交成功");cancel.style.display='none';cancel.onclick=null;t.I('comment_parent').value='0';if(temp&&respond){temp.parentNode.insertBefore(respond,temp);temp.parentNode.removeChild(temp)}}});return false});addComment={moveForm:function(commId,parentId,respondId){var t=this,div,comm=t.I(commId),respond=t.I(respondId),cancel=t.I('cancel-comment-reply-link'),parent=t.I('comment_parent'),post=t.I('comment_post_ID');__cancel.text(__cancel_text);t.respondId=respondId;if(!t.I('wp-temp-form-div')){div=document.createElement('div');div.id='wp-temp-form-div';div.style.display='none';respond.parentNode.insertBefore(div,respond)}!comm?(temp=t.I('wp-temp-form-div'),t.I('comment_parent').value='0',temp.parentNode.insertBefore(respond,temp),temp.parentNode.removeChild(temp)):comm.parentNode.insertBefore(respond,comm.nextSibling);jQuery("body").animate({scrollTop:jQuery('#respond').offset().top-180},400);parent.value=parentId;cancel.style.display='';cancel.onclick=function(){var t=addComment,temp=t.I('wp-temp-form-div'),respond=t.I(t.respondId);t.I('comment_parent').value='0';if(temp&&respond){temp.parentNode.insertBefore(respond,temp);temp.parentNode.removeChild(temp)}this.style.display='none';this.onclick=null;return false};try{t.I('comment').focus()}catch(e){}return false},I:function(e){return document.getElementById(e)},createButterbar:function(message){var t=this;layer.msg(message)}}});$(function(){window.addEventListener("popstate",function(e){if(e.state){document.title=e.state.title;$("#container").html(e.state.html);window.load=$(this).kratos_pjax_reload()}})});function body_am(id){id=isNaN(id)?$("#"+id).offset().top-document.getElementById("kratos-header-section").offsetHeight-12:$("#kratos-blog-post").offset().top-document.getElementById("kratos-header-section").offsetHeight;$("body,html").animate({scrollTop:id},600);return false}function to_am(url){var anchor=location.hash.indexOf("#");anchor=window.location.hash.substring(anchor+1);body_am(anchor)}var home_url="//"+window.location.hostname+"/";function replaceUrl(url,domain){return url.replace(/\/\/([^\/]+)\//i,domain)}function getFormJson(frm){var o={};var a=$(frm).serializeArray();$.each(a,function(){if(o[this.name]!==undefined){if(!o[this.name].push){o[this.name]=[o[this.name]]}o[this.name].push(this.value||"")}else{o[this.name]=this.value||""}});return o}function l(){history.replaceState({url:window.document.location.href,title:window.document.title,html:$(document).find("#container").html(),},window.document.title,document.location.href)}function ajax(reqUrl,msg,method,data){if(msg=="pagelink"||msg=="search"){$("#container").fadeTo(500,0.5)}else{if(msg=="comtreply"){$(".comment-list").fadeTo(500,0.5)}else{if(msg=="comment"){$("html").fadeTo(500,0.5)}else{if(msg=="comtpagenav"){$(".comment-list").fadeTo(500,0.5);$("#comments-nav").fadeTo(500,0.5)}}}}$.ajax({url:reqUrl,type:method,data:data,beforeSend:function(){l()},success:function(data){NProgress.start();if(msg=="pagelink"||msg=="search"){$("#container").html($(data).find("#container").html());$("#container").fadeTo(700,1)}else{if(msg=="comtreply"){$(".comment-list").fadeTo(700,1)}else{if(msg=="comment"){$("#container").html($(data).find("#container").html());$("body").click();$("html").fadeTo(700,1)}else{if(msg=="comtpagenav"){var content=$(data).find("#container").html();var pagedstring=$(data).find("#comments-nav").html();$("#container").html(content);$("#comments-nav").html(pagedstring);$("body,html").animate({scrollTop:$(".comment-list").offset().top-document.getElementById("kratos-header-section").offsetHeight-12},600);$(".comment-list").fadeTo(700,1);$("#comments-nav").fadeTo(700,1)}}}}document.title=$(data).filter("title").text();if(msg!="comment"){var state={url:reqUrl,title:$(data).filter("title").text(),html:$(data).find("#container").html(),};window.history.pushState(state,$(data).filter("title").text(),reqUrl)}},complete:function(){if(msg=="pagelink"||msg=="search"){to_am(reqUrl)}NProgress.done();window.load=$(this).kratos_pjax_reload()},timeout:25000,error:function(request){if(msg=="comtpagenav"){$(".comment-list").fadeTo(700,1);$("#comments-nav").fadeTo(700,1)}else{location.href=reqUrl}},})}$(document).on("click","*:not(.reply)>a[target!=_blank]",function(){if($(this).attr("href")){var req_url=$(this).attr("href")}else{var req_url=""}if((req_url.indexOf("javascript:")!==-1)||(req_url.indexOf(".php")!==-1)||(!req_url)){return true}else{ajax($(this).attr("href"),"pagelink")}return false});$(document).on("click","#comments-nav a",function(){ajax($(this).attr("href"),"comtpagenav");return false});$(document).on("submit","#searchform",function(){ajax(this.action+"?s="+$(this).find("#search").val(),"search");return false});(function(root,factory){if(typeof define==="function"&&define.amd){define(factory)}else{if(typeof exports==="object"){module.exports=factory()}else{root.NProgress=factory()}}})(this,function(){var NProgress={};NProgress.version="0.2.0";var Settings=NProgress.settings={minimum:0.08,easing:"linear",positionUsing:"",speed:200,trickle:true,trickleSpeed:200,showSpinner:true,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};NProgress.configure=function(options){var key,value;for(key in options){value=options[key];if(value!==undefined&&options.hasOwnProperty(key)){Settings[key]=value}}return this};NProgress.status=null;NProgress.set=function(n){var started=NProgress.isStarted();n=clamp(n,Settings.minimum,1);NProgress.status=(n===1?null:n);var progress=NProgress.render(!started),bar=progress.querySelector(Settings.barSelector),speed=Settings.speed,ease=Settings.easing;progress.offsetWidth;queue(function(next){if(Settings.positionUsing===""){Settings.positionUsing=NProgress.getPositioningCSS()}css(bar,barPositionCSS(n,speed,ease));if(n===1){css(progress,{transition:"none",opacity:1});progress.offsetWidth;setTimeout(function(){css(progress,{transition:"all "+speed+"ms linear",opacity:0});setTimeout(function(){NProgress.remove();next()},speed)},speed)}else{setTimeout(next,speed)}});return this};NProgress.isStarted=function(){return typeof NProgress.status==="number"};NProgress.start=function(){if(!NProgress.status){NProgress.set(0)}var work=function(){setTimeout(function(){if(!NProgress.status){return}NProgress.trickle();work()},Settings.trickleSpeed)};if(Settings.trickle){work()}return this};NProgress.done=function(force){if(!force&&!NProgress.status){return this}return NProgress.inc(0.3+0.5*Math.random()).set(1)};NProgress.inc=function(amount){var n=NProgress.status;if(!n){return NProgress.start()}else{if(n>1){return}else{if(typeof amount!=="number"){if(n>=0&&n<0.2){amount=0.1}else{if(n>=0.2&&n<0.5){amount=0.04}else{if(n>=0.5&&n<0.8){amount=0.02}else{if(n>=0.8&&n<0.99){amount=0.005}else{amount=0}}}}}n=clamp(n+amount,0,0.994);return NProgress.set(n)}}};NProgress.trickle=function(){return NProgress.inc()};(function(){var initial=0,current=0;NProgress.promise=function($promise){if(!$promise||$promise.state()==="resolved"){return this}if(current===0){NProgress.start()}initial++;current++;$promise.always(function(){current--;if(current===0){initial=0;NProgress.done()}else{NProgress.set((initial-current)/initial)}});return this}})();NProgress.render=function(fromStart){if(NProgress.isRendered()){return document.getElementById("nprogress")}addClass(document.documentElement,"nprogress-busy");var progress=document.createElement("div");progress.id="nprogress";progress.innerHTML=Settings.template;var bar=progress.querySelector(Settings.barSelector),perc=fromStart?"-100":toBarPerc(NProgress.status||0),parent=document.querySelector(Settings.parent),spinner;css(bar,{transition:"all 0 linear",transform:"translate3d("+perc+"%,0,0)"});if(!Settings.showSpinner){spinner=progress.querySelector(Settings.spinnerSelector);spinner&&removeElement(spinner)}if(parent!=document.body){addClass(parent,"nprogress-custom-parent")}parent.appendChild(progress);return progress};NProgress.remove=function(){removeClass(document.documentElement,"nprogress-busy");removeClass(document.querySelector(Settings.parent),"nprogress-custom-parent");var progress=document.getElementById("nprogress");progress&&removeElement(progress)};NProgress.isRendered=function(){return!!document.getElementById("nprogress")};NProgress.getPositioningCSS=function(){var bodyStyle=document.body.style;var vendorPrefix=("WebkitTransform"in bodyStyle)?"Webkit":("MozTransform"in bodyStyle)?"Moz":("msTransform"in bodyStyle)?"ms":("OTransform"in bodyStyle)?"O":"";if(vendorPrefix+"Perspective"in bodyStyle){return"translate3d"}else{if(vendorPrefix+"Transform"in bodyStyle){return"translate"}else{return"margin"}}};function clamp(n,min,max){if(n<min){return min}if(n>max){return max}return n}function toBarPerc(n){return(-1+n)*100}function barPositionCSS(n,speed,ease){var barCSS;if(Settings.positionUsing==="translate3d"){barCSS={transform:"translate3d("+toBarPerc(n)+"%,0,0)"}}else{if(Settings.positionUsing==="translate"){barCSS={transform:"translate("+toBarPerc(n)+"%,0)"}}else{barCSS={"margin-left":toBarPerc(n)+"%"}}}barCSS.transition="all "+speed+"ms "+ease;return barCSS}var queue=(function(){var pending=[];function next(){var fn=pending.shift();if(fn){fn(next)}}return function(fn){pending.push(fn);if(pending.length==1){next()}}})();var css=(function(){var cssPrefixes=["Webkit","O","Moz","ms"],cssProps={};function camelCase(string){return string.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(match,letter){return letter.toUpperCase()})}function getVendorProp(name){var style=document.body.style;if(name in style){return name}var i=cssPrefixes.length,capName=name.charAt(0).toUpperCase()+name.slice(1),vendorName;while(i--){vendorName=cssPrefixes[i]+capName;if(vendorName in style){return vendorName}}return name}function getStyleProp(name){name=camelCase(name);return cssProps[name]||(cssProps[name]=getVendorProp(name))}function applyCss(element,prop,value){prop=getStyleProp(prop);element.style[prop]=value}return function(element,properties){var args=arguments,prop,value;if(args.length==2){for(prop in properties){value=properties[prop];if(value!==undefined&&properties.hasOwnProperty(prop)){applyCss(element,prop,value)}}}else{applyCss(element,args[1],args[2])}}})();function hasClass(element,name){var list=typeof element=="string"?element:classList(element);return list.indexOf(" "+name+" ")>=0}function addClass(element,name){var oldList=classList(element),newList=oldList+name;if(hasClass(oldList,name)){return}element.className=newList.substring(1)}function removeClass(element,name){var oldList=classList(element),newList;if(!hasClass(element,name)){return}newList=oldList.replace(" "+name+" "," ");element.className=newList.substring(1,newList.length-1)}function classList(element){return(" "+(element&&element.className||"")+" ").replace(/\s+/gi," ")}function removeElement(element){element&&element.parentNode&&element.parentNode.removeChild(element)}return NProgress});